<html>
<head>
<title>QFfilter</title>
<script src="qfiltr.js"></script>

<script type="text/javascript">

// create instance of qfiltr
var filt = new qfilter();

// a random number generator to excersize the functions
var generateRandom = function generateRandom(start, count) {   
    var amount = count || 100;
    var begin = start || 0;
    return Math.floor(Math.exp(Math.random()*Math.log(count+1)))+start;
};

// Function called when the Limit Run Button is pressed
var runFunc = function() {

    var state = document.getElementById("state");

    // call filt.limit to test limiter using options 
    filt.limit("derp", {}, function() {  
        console.log("Allow action"); 
        var node = document.createElement("LI");                 
        var textnode = document.createTextNode(generateRandom(0,10000000000000));   
        var container =  document.getElementById("filterResult");
        node.appendChild(textnode);                              
        container.insertBefore(node, container.firstChild);           
        state.innerHTML = "Status: OK";   
    }, function() { 
        console.log("Rate limit exceeded");
        state.innerHTML = "You're going too fast!";
    });  
  
};

// Function called when the Queue Run Button is pressed
var qFunc = function() {

    var qstate = document.getElementById("qstate");

    filt.queue("herp", {queueTimer:1000}, function() {
        console.log("Allow action"); 
        var node = document.createElement("LI");                 
        var textnode = document.createTextNode(generateRandom(0,10000000000000));   
        var container =  document.getElementById("qResult");
        node.appendChild(textnode);                              
        container.insertBefore(node, container.firstChild);           
        qstate.innerHTML = "Queue Running: " + filt.qRunning["herp"] + 
            "<br>Queue Items: " + filt.dataStore["herp"].length;    
    },
    function() { 
        console.log("Queue stopped");
        qstate.innerHTML = "Queue Running: " + filt.qRunning["herp"]; 
    });
};

</script>

</head>
<body>

<center><h2>Limit</h2></center>
<table align="center" width="600"><tr><td>
    <div id="filterResult" style="width:300px;height:200px;overflow:scroll"></div>
</td>
<td>
    <div id="state">Status: OK</div>
</td></tr></table>

<center>
    <button id="runner" onClick="runFunc()">Run Function</button>
</center>

<center><h2>Queue</h2></center>
<table align="center" width="600"><tr><td>
    <div id="qResult" style="width:300px;height:200px;overflow:scroll"></div>
</td>
<td>
    <div id="qstate">Queue Running: false</div>
</td></tr></table>

<center>
    <button id="qRunner" onClick="qFunc()">Run Function</button>
</center>

</body>
</html>